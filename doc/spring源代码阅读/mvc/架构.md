# 初始化
-RequestMappingInfo类，对RequestMapping注解封装。里面包含注解配置的所有信息。一个RequestMapping注解对应一个RequestMappingInfo实例。且唯一（就是所有配置项加在一起不重复）
-HandlerMethod类，是对Controller的处理请求方法的封装。里面包含了该方法所属的bean对象、该方法对应的method对象、该方法的参数等。

AbstractHandlerMethodMapping.initHandlerMethods 获取context所有bean
  RequestMappingHandlerMapping.isHandler 筛选bean，根据类是否有controller或requestMapping注解 
  detectHandlerMethods 遍历并筛选所有符合条件的class的method，根据注解生成RequestMappingInfo - 用于匹配请求，结合类和方法生成HandlerMethod - 用于请求的处理器
    RequestMappingHandlerMapping.getMappingForMethod 生成方法和类的RequestMapping实例，合并

    register 
      createHandlerMethod 生成handelrMethod对象，包含：bean，beanClass，method，method对应的注解参数list，responseStatus和responsereason
      validateMethodMapping 验证mapping是否有重复的bean
      mappingLookup：RequestMappingInfo -> HandlerMethod
      urlLookup：直接设置的url -> RequestMappingInfo 



1. 筛选所有bean的class，看class层装饰器是否有controller或requestMapping注解 
2. 对每个class的方法进行筛选是否含有RequestMapping注解
3. 如果有注解，根据method注解，生成一个RequestMappingInfo对象，并和所属类的RequestMappingInfo合并
4. 根据类和method生成handlerMethod实例，和requestMappingInfo一起注册成map，key是requestMappingInfo，值是handlerMethod，（不能重复。重复的意思是，两个requestMappingInfo的各种条件是一样的url一致，method一致，请求参数，请求头，consume，produces，custom就是说相同配置的requestMappingInfo只能映射一个handlerMethod.）。

# doDispatch

DispatcherServlet.doDispatch
  checkMultipart - 查找是否文件上传
  getHandler  返回HandlerExecutionChain 包含HandlerMethod和拦截器查找urlLookup(url直接映射)，如果没找到，遍历mappingLookup查找匹配的info。然后对info排序，返回最符合的一个handlerMethod实例 排序规则 value>params>headers>consumes>produces>methods>custom
    AbstractHandlerMapping.getHandler
      AbstractHandlerMethodMapping.getHandlerInternal
        lookupHandlerMethod 查找urlLookup(url直接映射)，执行RequestMappingInfo.getMatchingCondition进行匹配。否则查找所有info执行上边方法进行匹配
          RequestMappingInfo.getMatchingCondition

  getHandlerAdapter 返回RequestMappingHandlerAdapter
 HandlerExecutionChain.applyPreHandle 执行前置拦截器，如果失败，停止后面代码
 AbstractHandlerMethodAdapter.handle 
  RequestMappingHandlerAdapter.handleInternal 
    invokeHandlerMethod https://juejin.im/post/6844904201265348621

    

1. 标识controller bean
2. 根据注解，生成条件 -> 实际执行bean的映射。


3. 请求到来，查找映射，找到最匹配的bean。查找拦截器，将拦截器和bean放到一起生成新对象。
4. 处理参数（参数解析器，遍历，isSupport then resolve 根据类型和注解）HandlerMethodArgumentResolver
5. 处理返回值（返回值解析器，根据类型和注解）
6. 返回值非空，查找视图，将model和视图结合渲染。

